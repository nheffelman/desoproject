#:kivy 2.0.0
#:import hex kivy.utils.get_color_from_hex
#:import CircularAvatarImage main.CircularAvatarImage
#:import StoryCreator main.StoryCreator
#:import PostCard main.PostCard
#:import kivymd kivymd



#login screen
<LoginScreen>:
    name: 'login'
    BoxLayout:
        orientation: 'vertical'
        padding: '10dp'
        spacing: '10dp'
        Image:
            source: 'assets/dragon.png'
            size_hint: (1, 1)
        Label:
            text: 'Login to Desoliscious'
            font_size: '20sp'
            text_size: self.size
            halign: 'center'
        Label:
            text: 'Read-only Mode'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDRoundFlatButton:
            on_press: root.manager.current = 'username_login'
            text: 'Login with Username'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        Label:
            text: 'Full Access Mode'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDRoundFlatButton:
            on_press: root.manager.current = 'seed_login'
            text: 'Login with Seed Phrase'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        Label:
            text: 'Full Access Mode'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDRoundFlatButton:
            text: 'Login with Desoliscious Identity'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        
        Label:
            text: "Don't have a Deso Account, Sign Up"
            font_size: '15sp'
            text_size: self.size
            halign: 'center'
            color: (0, 0, 1, 1)
            underline: True
        MDRoundFlatButton:
            text: 'Sign Up'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
            on_press: root.manager.current = 'signup'

#seed login screen
<SeedLoginScreen>:
    name: 'seed_login'
    MDBoxLayout:
        orientation: 'vertical'
        # App Bar
        MDBoxLayout:
            adaptive_height: True
            id: appbar
            MDIconButton:
                icon: 'arrow-left'
                on_press: root.manager.current = 'login'
            MDLabel:
                id: username
                text: 'Desoliscious'
                halign: 'center'
                valign: 'top'
                font_size: 50
                font_name: 'assets/Instafont.otf'
        MDBoxLayout:
            orientation: 'vertical'
            padding: '10dp'
            spacing: '10dp'
            
            Label:
                text: 'Login with Seed Phrase'
                font_size: '20sp'
                text_size: self.size
                halign: 'center'
            MDTextField:
                id: seedphrase
                hint_text: 'Seed Phrase'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.8, None)
                height: '40dp'
                on_text_validate: root.textInput(self)
            MDTextField:
                id: userName
                hint_text: 'Username'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.8, None)
                height: '40dp'
                on_text_validate: root.textInput(self)
            MDRoundFlatButton:
                text: 'Login'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.8, None)
                height: '40dp'
                on_press: root.onClick()
            Widget:



<SignupScreen>:
    name: 'signup'
    BoxLayout:
        orientation: 'vertical'
        padding: '10dp'
        spacing: '10dp'
        Image:
            source: 'assets/dragon.png'
            size_hint: (1, 1)
        Label:
            text: 'Sign up to check out the newest iteration of Deso.'
            font_size: '20sp'
            text_size: self.size
            halign: 'center'
        MDTextField:
            hint_text: 'Email'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDTextField:
            hint_text: 'Full Name'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDTextField:
            hint_text: 'Username'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
        MDTextField:
            hint_text: 'Password'
            pos_hint: {'center_x': 0.5}
            size_hint: (0.8, None)
            height: '40dp'
            password: True
        Button:
            text: 'Sign up'
            size_hint: (0.8, None)
            height: '40dp'
            pos_hint: {'center_x': 0.5}
        Label:
            text: 'By signing up, you agree to our Terms & Privacy Policy.'
            font_size: '10sp'
            text_size: self.size
            halign: 'center'
        MDRoundFlatButton:
        	on_press: root.manager.current = 'login'
        	pos_hint: {'center_x': 0.5}
            text: 'Have an account? Log in'
        	font_size: '15sp'
       	 text_size: self.size
    	    halign: 'center'
            color: (0, 0, 1, 1)
        	underline: True
            

<UserNameLoginScreen>:
    name: 'username_login'
    MDBoxLayout:
        orientation: 'vertical'
        # App Bar
        MDBoxLayout:
            adaptive_height: True
            id: appbar
            MDIconButton:
                icon: 'arrow-left'
                on_press: root.manager.current = 'login'
            MDLabel:
                id: username
                text: 'Desoliscious'
                halign: 'center'
                valign: 'top'
                font_size: 50
                font_name: 'assets/Instafont.otf'
    
        MDBoxLayout:
            orientation: 'vertical'
            padding: '10dp'
            spacing: '10dp'
            MDLabel:
                text: 'Login with Username'
                font_size: '20sp'
                text_size: self.size
                halign: 'center'
            MDTextField:
                id: username
                hint_text: 'Username'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.8, None)
                height: '40dp'
                on_text_validate: root.textInput(self)
            MDRoundFlatButton:
                text: 'Login'
                pos_hint: {'center_x': 0.5}
                size_hint: (0.8, None)
                height: '40dp'
                on_press: root.onClick()
            Widget:




#singe post read only screen with mdpostcard
<SinglePostScreen>:
    name: 'single_post'
    
    MDBoxLayout:
        orientation: 'vertical'
        # App Bar
        OneLineIconListItem:
            adaptive_height: True
            id: appbar
            text: root.txnHashHex
            theme_text_color: 'Custom'
            text_color: colors['Gray']['500']
            divider: None
            IconLeftWidget:
                icon: 'arrow-left'
                on_press: root.manager.current = 'homepage_read_only'
                
            
        MDBoxLayout:
            ScrollView:
                bar_width: 0

                MDBoxLayout:
                    adaptive_height: True
                    
                    MDBoxLayout:
                        orientation: 'vertical'
                        adaptive_height: True
                        id: singlePost 

        MDBoxLayout:
            adaptive_height: True
            size_hint: (1, .1)MDBoxLayout:
            adaptive_height: True
            size_hint: (1, .1)
            anchor: 'bottom'
            id: bottombar
            MDBoxLayout:
                size_hint: (2, 1)
                MDIconButton:
                    icon: 'home'
                    on_press: root.home_pressed()
            MDBoxLayout:
                size_hint: (2, 1)
                MDIconButton:
                    icon: 'magnify'
            MDBoxLayout:
                size_hint: (2, 1)
                MDIconButton:
                    icon: 'plus-box-outline'
                    on_press: root.manager.current = 'create_post'
            MDBoxLayout:
                size_hint: (2, 1)
                MDIconButton:
                    on_press: root.manager.current = 'notifications'
                    icon: 'alert-circle-outline'
            MDBoxLayout:
                size_hint: (2, 1)
                MDIconButton:
                    icon: 'message-text-outline'
            


<HomePageReadOnlyScreen>:

    name: 'homepage_read_only'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        anchor: 'top'
                        id: appbar
                        size_hint: (1, .125)

                        MDBoxLayout:
                            size_hint: (.2, 1)
                            OneLineAvatarListItem:
                                divider: None

                                ImageLeftWidget:
                                    source: root.profile_picture
                                    on_press  : nav_drawer.set_state("open")                                    
                                    radius: 50

                        MDBoxLayout:
                            size_hint: (.3, 1)
                                                        
                            MDRectangleFlatButton:
                                pos_hint: {'center_y': .42}
                                id: trending
                                text_color: "black"
                                line_color: "blue"
                                on_press: root.trending_pressed()
                                text: 'Trending'

                        MDBoxLayout: 
                            size_hint: (.3, 1)
                            
                            MDRectangleFlatButton:
                                pos_hint: {'center_y': .42}
                                id: following
                                text_color: "black"
                                line_color: "blue"
                                text: 'Following'
                                on_press: root.following_pressed()
                        
                        MDBoxLayout:
                            size_hint: (.2, 1)
                            MDLabel:
                                pos_hint: {'center_y': .42}
                                id: desoprice
                                text: '$'+root.desoprice
                            
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout

                                # Stories
                                ScrollView:
                                    size_hint_y: None
                                    height: 110
                                    bar_width: 0
                                    MDBoxLayout:
                                        adaptive_width: True
                                        spacing: 5
                                        padding: 5
                                        MDBoxLayout:
                                            adaptive_width: True
                                            padding: 5
                                            spacing: 5
                                            id: stories

                                

                                MDBoxLayout:
                                    orientation: 'vertical'
                                    adaptive_height: True
                                    spacing: '50'
                                    id: timeline

                                

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint: (1, .1)
                        anchor: 'bottom'
                        id: bottombar
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'home'
                                on_press: root.home()
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'magnify'
                                on_press: root.manager.current = 'search'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'plus-box-outline'
                                on_press: root.manager.current = 'create_post'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                on_press: root.manager.current = 'notifications'
                                icon: 'alert-circle-outline'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'message-text-outline'
        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Account Info"
                    title_color: "#4a4939"
                    text: root.username
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

                DrawerClickableItem:
                    icon: "account"
                    text: "Profile"
                    on_press: root.slideout_profile_pressed()
                    

                DrawerClickableItem:
                    icon: "bookmark"
                    #right_text: "+99"
                    text: "Bookmarks"
                    text_right_color: "#4a4939"
                    on_press: root.bookmarksPressed()

                DrawerClickableItem:
                    icon: "tree"
                    #right_text: "+99"
                    text: "Trees"
                    text_right_color: "#4a4939"
                    on_press: root.treesPressed()

                MDNavigationDrawerDivider:

                DrawerClickableItem:
                    icon: "code-json"
                    text: "Transactions"
                    on_press: root.transactions()

                DrawerClickableItem:
                    icon: "home"
                    text: "Home"
                    on_press: root.home()

                DrawerClickableItem:
                    icon: "close"
                    text: "Log out"
                    on_press: root.ids.timeline.clear_widgets()
                    on_press: root.logout()

<BookmarksScreen>:

    name: 'bookmarks'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        anchor: 'top'
                        id: appbar
                        
                        OneLineIconListItem:
                            adaptive_height: True
                            id: appbar
                            text: 'Bookmarks'
                            theme_text_color: 'Custom'
                            text_color: colors['Gray']['A100']
                            theme_font_style: 'H4'
                            divider: None
                            IconLeftWidget:
                                icon: 'arrow-left'
                                on_press: root.manager.current = 'homepage_read_only'
                                
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout

                                MDBoxLayout:
                                    orientation: 'vertical'
                                    adaptive_height: True
                                    spacing: '50'
                                    id: timeline

                                

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint: (1, .1)
                        anchor: 'bottom'
                        id: bottombar
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'home'
                                on_press: root.home()
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'magnify'
                                on_press: root.manager.current = 'search'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'plus-box-outline'
                                on_press: root.manager.current = 'create_post'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                on_press: root.manager.current = 'notifications'
                                icon: 'alert-circle-outline'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'message-text-outline'
        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Account Info"
                    title_color: "#4a4939"
                    text: root.username
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

                DrawerClickableItem:
                    icon: "account"
                    text: "Profile"
                    on_press: root.slideout_profile_pressed()
                    

                DrawerClickableItem:
                    icon: "send"
                    right_text: "+99"
                    text: "Chat"
                    text_right_color: "#4a4939"

                MDNavigationDrawerDivider:

                DrawerClickableItem:
                    icon: "code-json"
                    text: "Transactions"
                    on_press: root.transactions()

                DrawerClickableItem:
                    icon: "home"
                    text: "Home"
                    on_press: root.home()

                DrawerClickableItem:
                    icon: "close"
                    text: "Log out"
                    on_press: root.ids.timeline.clear_widgets()
                    on_press: root.logout()

<TreesScreen>:

    name: 'trees'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        anchor: 'top'
                        id: appbar
                        
                        OneLineIconListItem:
                            adaptive_height: True
                            id: appbar
                            text: 'Trees'
                            theme_text_color: 'Custom'
                            text_color: colors['Gray']['A100']
                            theme_font_style: 'H4'
                            divider: None
                            IconLeftWidget:
                                icon: 'arrow-left'
                                on_press: root.manager.current = 'homepage_read_only'
                                
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout

                                MDBoxLayout:
                                    orientation: 'vertical'
                                    adaptive_height: True
                                    spacing: '50'
                                    id: timeline

                                

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint: (1, .1)
                        anchor: 'bottom'
                        id: bottombar
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'home'
                                on_press: root.home()
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'magnify'
                                on_press: root.manager.current = 'search'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'plus-box-outline'
                                on_press: root.manager.current = 'create_post'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                on_press: root.manager.current = 'notifications'
                                icon: 'alert-circle-outline'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'message-text-outline'
        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Account Info"
                    title_color: "#4a4939"
                    text: root.username
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

                DrawerClickableItem:
                    icon: "account"
                    text: "Profile"
                    on_press: root.slideout_profile_pressed()
                    

                DrawerClickableItem:
                    icon: "send"
                    right_text: "+99"
                    text: "Chat"
                    text_right_color: "#4a4939"

                MDNavigationDrawerDivider:

                DrawerClickableItem:
                    icon: "code-json"
                    text: "Transactions"
                    on_press: root.transactions()

                DrawerClickableItem:
                    icon: "home"
                    text: "Home"
                    on_press: root.home()

                DrawerClickableItem:
                    icon: "close"
                    text: "Log out"
                    on_press: root.ids.timeline.clear_widgets()
                    on_press: root.logout()

<ProfileScreen>:

    name: 'profile'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'                    
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        anchor: 'left'
                        id: titlebar
                        orientation: 'horizontal'
                        spacing: '10'
                        size_hint: (1, .08)
                        MDIconButton:
                            icon: 'arrow-left'
                            on_press: root.manager.current = 'homepage_read_only'
                            padding: 50

                        MDBoxLayout:                            
                            orientation: 'vertical'  

                            MDLabel:
                                id: profileName                                
                                text: root.profileName                     
                                font_size: 20
                                font_name: 'assets/Instafont.otf'
                            MDLabel:
                                id: cloutNumber
                                font_size: 12
                                text: root.cloutNumber

                      
                            
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout

                                MDBoxLayout:
                                    adaptive_height: True
                                    id: profileLayout
                                    orientation: 'vertical'
                                    spacing: '15'
                                    
                                    MDBoxLayout:
                                        id: largePictureBox
                                       
                                        size_hint_y: None
                                        height: "125dp"
                                        orientation: 'vertical'
                                        MDLabel:
                                        	halign: "center"
                                        	theme_text_color: "Custom"
                                        	text_color: "white"
                                        	text: 'Desoliscious'
                                        	font_name: 'assets/Instafont.otf'
                                        	font_size: 30
                                        	valign: 'center'                                     

                                        FitImage:
                                            id: largePicture
                                            source: root.largePicture
                                            size_hint: (1, .23)
                                            pos_hint: {'center_y': 1}
                                            allow_stretch: True

                                    MDBoxLayout:
                                        adaptive_height: True 
                                        id: middlebar
                                        orientation: 'horizontal'
                                        spacing: '10'
                                        
                                        CircularAvatarImage:
                                            #padding: 50
                                            avatar: root.avatar
                                            size: '50dp', '50dp'
                                            on_press  : nav_drawer.set_state("open")

                                        MDIconButton:
                                            icon: 'dots-horizontal'
                                            line_color: rgba(134, 122, 128, 0.8)
                                        
                                        MDIconButton:
                                            icon: 'email'

                                        MDIconButton:
                                            icon: 'bell-plus-outline'

                                        MDRoundFlatButton:
                                            id: followButton
                                            text: 'Follow'
                                            font_size: "18sp"
                                            theme_text_color: "Custom"
                                        	text_color: "black"
                                    
                                    MDBoxLayout:
                                        adaptive_height: True 
                                        id: descriptionbar
                                        orientation: 'vertical'
                                        spacing: '30'
                                        
                                        MDLabel:
                                            id: description
                                            adaptive_height: True
                                            pos_hint: {"center_x": .5, "center_y": .5}
                                            text: root.description
                                            font_size: 20
                                            text_color: "black"

                                    MDBoxLayout:
                                        adaptive_height: True
                                        id: primary_details
                                        orientation: 'vertical'
                                        spacing: '5'
                                                                                
                                        MDBoxLayout:
                                            adaptive_height: True
                                            id: primary_details
                                            orientation: 'horizontal'
                                            
                                            
                                            
                                            MDIcon:
                                                icon: "web" 
                                                font_size: 20
                                                pos_hint: {"center_x": .5, "center_y": .5}

                                            MDLabel:
                                                id: website
                                                text: root.website
                                                font_size: 20
                                                text_color: "blue"
                                                pos_hint: {"center_x": .5, "center_y": .5}

                                        MDBoxLayout:
                                            orientation: 'horizontal'
                                            adaptive_height: True
                                            spacing: '10'
                                        
                                            MDIcon:
                                                icon: "calendar" 
                                                font_size: 20
                                                pos_hint: {"center_x": .5, "center_y": .5}
                                            MDLabel:
                                                id: birthblock
                                                text: root.birthblock

                                        MDBoxLayout:
                                            adaptive_height: True 
                                            id: following_details
                                            orientation: 'horizontal'
                                            spacing: '10'
                                            size_hint_x: .8
                                            pos_hint: {"center_x": .5, "center_y": .5}
                                            
                                            MDBoxLayout:
                                                orientation: 'vertical'
                                                adaptive_height: True
                                                pos_hint: {"center_x": .5, "center_y": .5}
                                                
                                                MDLabel:
                                                    text: "Followers"
                                                    font_size: 14
                                                    text_color: "black"
                                                    pos_hint: {"center_x": .5, "center_y": .5}

                                                MDLabel: 
                                                    id: followersNumber
                                                    text: str(root.followersNumber)
                                                    font_size: 20
                                                    pos_hint: {"center_x": .5, "center_y": .5}

                                            MDSeparator:
                                                orientation: 'vertical'
                                                height: "25dp"
                                                width: "1dp"
                                                pos_hint: {"center_x": .5, "center_y": .5}
                                                color: "black"

                                            MDBoxLayout:
                                                orientation: 'vertical'
                                                adaptive_height: True
                                                pos_hint: {"center_x": .5, "center_y": .5}

                                                MDLabel:
                                                    text: "Following"
                                                    font_size: 14
                                                    text_color: "black"
                                                    pos_hint: {"center_x": .5, "center_y": .5}

                                                MDLabel: 
                                                    id: followingNumber
                                                    text: str(root.followingNumber)
                                                    font_size: 20    
                                                    pos_hint: {"center_x": .5, "center_y": .5}  

                                            MDSeparator:
                                                orientation: 'vertical'
                                                height: "25dp"
                                                width: "1dp"
                                                pos_hint: {"center_x": .5, "center_y": .5}
                                                color: "black"

                                            MDBoxLayout:
                                                orientation: 'vertical'
                                                adaptive_height: True
                                                pos_hint: {"center_x": .5, "center_y": .5}

                                                MDLabel:
                                                    text: "Coin Price"
                                                    font_size: 14
                                                    text_color: "black"
                                                    pos_hint: {"center_x": .5, "center_y": .5}

                                                MDLabel: 
                                                    id: coinPriceNumber
                                                    text: root.coinPriceNumber
                                                    font_size: 20    
                                                    pos_hint: {"center_x": .5, "center_y": .5}                            

                                MDBoxLayout:
                                    orientation: 'vertical'
                                    adaptive_height: True
                                    spacing: '50'
                                    id: timeline

                                

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint: (1, .1)
                        anchor: 'bottom'
                        id: bottombar
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'home'
                                on_press: root.home_pressed()
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'magnify'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'plus-box-outline'
                                on_press: root.manager.current = 'create_post'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                on_press: root.manager.current = 'notifications'
                                icon: 'alert-circle-outline'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'message-text-outline'
        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Account Info"
                    title_color: "#4a4939"
                    text: root.profileName
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

                DrawerClickableItem:
                    id: profile
                    icon: "account"
                    text: "Profile"
                    on_press: root.slideout_profile_pressed()
                    

                DrawerClickableItem:
                    icon: "send"
                    right_text: "+99"
                    text: "Chat"
                    text_right_color: "#4a4939"

                MDNavigationDrawerDivider:

                MDNavigationDrawerLabel:
                    text: "Labels"

                DrawerClickableItem:
                    icon: "home"
                    text: "Home"
                    on_press: root.home_pressed()

                DrawerClickableItem:
                    icon: "close"
                    text: "Log out"
                    on_press: root.ids.timeline.clear_widgets()
                    on_press: root.logout()

<SearchScreen>:

    name: 'search'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'                    
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        id: titlebar
                        orientation: 'horizontal'
                        spacing: '10'
                        size_hint: (1, .08)
                        MDIconButton:
                            icon: 'arrow-left'
                            on_press: root.manager.current = 'homepage_read_only'
                            padding: 50

                        MDBoxLayout:                            
                            orientation: 'vertical'  
                            id: searchBoxLayout
                            size_hint: (.8, 1)

                            MDTextField:
                                hint_text: "Desoliscious"
                                mode: "round"
                                helper_text: "Search Deso"
                                on_text_validate: root.search()
                                id: searchField

                                MDIconButton:
                                    icon: "magnify"
                                    pos_hint: {"center_x": .05, "center_y": .5}
                                    theme_text_color: "Hint"
                        Widget:
                            size_hint: (.1, 1)
                            id: searchBoxRight
                                    
                                                        

                      
                            
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout

                                MDBoxLayout:
                                    adaptive_height: True
                                    id: searchLayout
                                    orientation: 'vertical'
                                    spacing: '15'

                                    MDTabs:
                                        id: tabs
                                        on_tab_switch: root.on_tab_switch(*args)

                                        Tab:
                                            icon: 'account'
                                            text: 'People'
                                            id: peopleTab
                                            
                                        Tab:
                                            icon: 'pound'
                                            text: 'Hashtags'
                                            id: hashtagsTab

                                       

                                    

                                MDBoxLayout:
                                    orientation: 'vertical'
                                    adaptive_height: True
                                    spacing: '50'
                                    id: timeline

                                

                    MDBoxLayout:
                        adaptive_height: True
                        size_hint: (1, .1)
                        anchor: 'bottom'
                        id: bottombar
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'home'
                                on_press: root.home_pressed()
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'magnify'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'plus-box-outline'
                                on_press: root.manager.current = 'create_post'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                on_press: root.manager.current = 'notifications'
                                icon: 'alert-circle-outline'
                        MDBoxLayout:
                            size_hint: (2, 1)
                            MDIconButton:
                                icon: 'message-text-outline'
        MDNavigationDrawer:
            id: nav_drawer
            radius: (0, 16, 16, 0)

            MDNavigationDrawerMenu:

                MDNavigationDrawerHeader:
                    title: "Account Info"
                    title_color: "#4a4939"
                    text: root.profileName
                    spacing: "4dp"
                    padding: "12dp", 0, 0, "56dp"

                DrawerClickableItem:
                    id: profile
                    icon: "account"
                    text: "Profile"
                    on_press: root.slideout_profile_pressed()
                    

                DrawerClickableItem:
                    icon: "send"
                    right_text: "+99"
                    text: "Chat"
                    text_right_color: "#4a4939"

                MDNavigationDrawerDivider:

                MDNavigationDrawerLabel:
                    text: "Labels"

                DrawerClickableItem:
                    icon: "home"
                    text: "Home"
                    on_press: root.home_pressed()

                DrawerClickableItem:
                    icon: "close"
                    text: "Log out"
                    on_press: root.ids.timeline.clear_widgets()
                    on_press: root.logout()


<Tab>

<TransactionsScreen>:

    name: 'transactions'
    orientation: 'vertical'
    
    MDNavigationLayout:
        MDScreenManager:

            MDScreen:
                MDBoxLayout:
                    orientation: 'vertical'                    
                    
                    # App Bar
                    MDBoxLayout:
                        adaptive_height: True 
                        id: titlebar
                        orientation: 'horizontal'
                        spacing: '10'
                        size_hint: (1, .08)
                        MDIconButton:
                            icon: 'arrow-left'
                            on_press: root.manager.current = 'homepage_read_only'
                            size_hint: (.1, 1)
                        Widget:
                            size_hint: (.4, 1)
                        MDLabel:
                            text: 'Transaction Dialog?'
                        MDSwitch:
                            id: transaction_dialog_switch
                            padding: 5
                            on_active: root.transaction_dialog_switch(*args)
                        Widget:
                            size_hint: (.1, 1)
                        
                    MDBoxLayout:
                        ScrollView:
                            bar_width: 0
                            id: mainScrollView
                            do_scroll_y: True
                            #on_touch_up: root.touch_up_value(self)

                            MDBoxLayout:
                                adaptive_height: True
                                orientation: 'vertical'
                                id: mainLayout


<CreatePostScreen>:
    name: 'create_post'
    orientation: 'vertical'
    MDBoxLayout:
        orientation: 'vertical'
        # App Bar
        anchor: 'top'
        MDBoxLayout:
            adaptive_height: True
            id: appbar
            anchor: 'top'
            size_hint: (1, .15)
            MDBoxLayout:
                size_hint: (.3, 1)                
                MDIconButton:
                    icon: 'arrow-left'
                    user_font_size: "96sp"   
                    text_color: app.theme_cls.primary_color
                    on_press: root.clearPostWidgets()             
                    on_press: root.manager.current = 'homepage_read_only'
            MDBoxLayout:
                size_hint: (.4, 1)
            MDBoxLayout:
                size_hint: (.3, 1)
                MDRaisedButton:
                    text: 'Post'                    
                    on_press: root.post()
        MDBoxLayout:
            id: userBox
            adaptive_height: True

        MDBoxLayout:
            adaptive_height: True
            MDTextField:
                id: postBox
                multiline: True
                hint_text: "Want to share something?"
                max_text_length: 1000

        MDBoxLayout:
            id: imageBox
            adaptive_height: True
            MDBoxLayout:
                orientation: 'horizontal'
                adaptive_height: True
                MDBoxLayout:
                    adaptive_height: True
                    MDIconButton:
                        icon: 'image'
                        user_font_size: "96sp"   
                        text_color: app.theme_cls.primary_color
                        on_press: root.select_image()
                MDBoxLayout:
                    adaptive_height: True
                    MDIconButton:
                        icon: 'gif'
                        user_font_size: "96sp"   
                        text_color: app.theme_cls.primary_color
                        on_press: root.select_gif()
                MDBoxLayout:
                    adaptive_height: True
                    MDIconButton:
                        icon: 'video'
                        user_font_size: "96sp"   
                        text_color: app.theme_cls.primary_color
                        #on_press: root.select_video()
                MDBoxLayout:
                    adaptive_height: True
                    MDIconButton:
                        icon: 'poll'
                        user_font_size: "96sp"   
                        text_color: app.theme_cls.primary_color
                        on_press: root.create_poll()

        Widget:

        MDBoxLayout:
            id: previewBox
            adaptive_height: True
        
<NotificationsScreen>:
    name: 'notifications'
    orientation: 'vertical'
    MDBoxLayout:
        id: box
        orientation: 'vertical'
        # App Bar
        MDTopAppBar:
            height: self.minimum_height
            size_hint: 1, 0.1
            title: 'Notifications'
            left_action_items: [['arrow-left', lambda x, : root.callback(x), "",'back']]
        MDBoxLayout:
            id: notBox  
            orientation: 'vertical'
            MDScrollView:
                id: scroll
                orientation: 'vertical'
                #scroll_timeout: 200
                MDList:
                    id: notificationsList      
        



<Circle@MDCard>
    size_hint: None, None
    elevation: 0
    pos_hint: {"center_x": 0.5, "center_y": 0.6}


<CircularAvatarImage>
    size_hint: None, None
    size: 62, 100
    elevation: 0

    MDRelativeLayout:
        size_hint: None, None
        size: 60, 100

        Circle:
            radius: [50, ]
            size: 60, 60
            md_bg_color: 1,0,0,1

        Circle:
            radius: [50, ]
            size: 55, 55
            md_bg_color: 1,1,1,1

        # profile picture
        FitImage:
            id: avatar
            source: root.avatar
            size_hint: None, None
            size: 53, 53
            radius: [53]
            pos_hint: {"center_x":0.5, "center_y":0.6}

        # Username
        MDLabel:
            id: name
            text: root.name
            halign: 'center'
            pos_hint: {"center_x:": 0.5, "center_y": 0.2}
            font_size: 11
            theme_text_color: "Custom"
            text_color: 0,0,0,  
    
    


<RecloutLayout@MDBoxLayout>
	#md_bg_color: 0,0,1,1
    adaptive_height: True	
    
<BodyLabel@ButtonBehavior+MDLabel>
    #md_bg_color: 1, 1, 0, 1
    adaptive_height: True
    font_name: "assets/NotoEmoji-Medium.ttf"
   

               

<PostLayout>
    id: postLayout
    orientation: 'vertical'
    size_hint: 1, None
        
    MDBoxLayout:
        id: nftButtonBox
        adaptive_height: True
        orientation: 'horizontal'


# fun result with low segments!
<LineEllipse3>:
    canvas:
        Color:
            rgba: 1, .1, .1, .9
        Line:
            width: 2.
            points: self.points
            


<Reactions@MDBoxLayout>
	adaptive_height: True
	

    MDBoxLayout:
        
        

        MDIconButton:
            id: like
            icon: "heart-outline"
                        
        MyLabel:
            id: likes
            valign: 'top'
            font_size: 10
            text: f'{root.likes}'
            bold: True

        MDIconButton:
            id: comment
            icon: 'message-outline'
            
		MyLabel:
            font_size: 10
			text: f'{root.comments}'
			
		MDIconButton:
            id: reclout
			icon: 'repeat'

		MyLabel:
            font_size: 10
			text: f'{root.reclout}'

        MDIconButton:
            id: bookmark
            icon: 'bookmark-outline'

        MyLabel: 
            font_size: 10
            

        MDIconButton:
            id: tree
            icon: 'tree-outline'

        MyLabel: 
            font_size: 10
            
        			
        MDIconButton:
            id: diamond
            icon: 'diamond-outline'
            
        MyLabel: 
            font_size: 10
			text: f'{root.diamonds}'
			bold: True

   
<PostCard>    
    orientation: 'vertical'
    size_hint_y: None
    #height: "630dp"  #started at 420dp
    #adaptive_height: True
    height: self.minimum_height
    spacing: 50
    elevation: 0
    padding: 5  

    
    MDBoxLayout:
        padding: 2
        adaptive_height: True

        OneLineAvatarListItem:
            text: f'[b][size=24]{root.username}[/size][/b]'
            divider: None
            _no_ripple_effect: True

            ImageLeftWidget:
                source: root.avatar
                radius: [20, ]
        MDIconButton:
            icon: 'dots-vertical'
            id: dots           

    
    MDBoxLayout:
        spacing: 10
        size_hint: 1, None
        id: bodyBox   
       
        
    MDBoxLayout:
        spacing: 10
        size_hint: 1, None
        id: mediaBox
    
    MDBoxLayout:
        id: nftButtonBox
        
    # Reactions
    MDBoxLayout:
        
        size_hint: 1, None
        padding: 5, 0, 0, 0
        spacings: 2
        adaptive_height: True

        MDIconButton:
            id: like
            icon: "heart-outline"
                        
        MyLabel:
            id: likeNumber
            valign: 'top'
            font_size: 10
            text: f'{root.likes}'
            bold: True

        MDIconButton:
            id: comment
            icon: 'message-outline'
            
		MyLabel:
            font_size: 10
			text: f'{root.comments}'
			
		MDIconButton:
            id: reclout
			icon: 'repeat'

		MyLabel:
            font_size: 10
			text: f'{root.reclout}'
			
        MDIconButton:
            id: diamond
            icon: 'diamond-outline'
            
        MyLabel: 
            font_size: 10
			text: f'{root.diamonds}'
			bold: True

     

    MDSeparator:




<MyLabel@MDLabel>
    adaptive_height:True
    font_size: 24

<HalfOpacityLabel@MyLabel>:
    theme_text_color: 'Custom'
    text_color: 0,0,0,0.5

<DrawerClickableItem@MDNavigationDrawerItem>
    focus_color: "#e7e4c0"
    text_color: "#4a4939"
    icon_color: "#4a4939"
    ripple_color: "#c5bdd2"
    selected_color: "#0c6c4d"


<DrawerLabelItem@MDNavigationDrawerItem>
    text_color: "#4a4939"
    icon_color: "#4a4939"
    focus_behavior: False
    selected_color: "#4a4939"
    _no_ripple_effect: True

<NotificationItem>
    text: root.text
    ImageLeftWidget:
        source: root.source
        radius: [20,20,20,20]

<Item>

    ImageLeftWidget:
        source: root.source

<CommentContent>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "420dp"

    MDTextField:
        id: comment
        pos_hint: {"center_x": .5, "center_y": .5}
        hint_text: "Add a comment"
        
        multiline: True
        max_text_length: 144

<Content>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "420dp"

    MDTextField:
        id: quote
        hint_text: "Add a comment"
        multiline: True
        max_text_length: 144
    MDWidget:
        size_hint: .5, None
        height: self.width
        radius: self.height / 2
        md_bg_color: app.theme_cls.primary_color

<NFTContent>
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "420dp"

    
    FitImage:
        id: nftImage
        height: "315dp"
        source: root.nftImage

    
        

    

    

        